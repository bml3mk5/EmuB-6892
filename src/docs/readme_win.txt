==============================================================================
    HITACHI BASIC MASTER LEVEL3 MARK5 Emulator
                                                             Version 2.0.5
                                                                2025/04/29

Copyright(C) Common Source Code Project, Sasaji 2011-2025 All Rights Reserved.
==============================================================================

● はじめに

  このソフトは、日立ベーシックマスターレベル3マーク5(MB-6892)のエミュレータ
  です。


------------------------------------------------------------------------------
● 索引
------------------------------------------------------------------------------

  ● 主な機能
  ● 動作確認環境
  ● 動作に必要なもの
  ● インストール
  ● アンインストール
  ● 使い方
    ○ メニュー説明
    ○ キー操作説明
    ○ ジョイパッド設定ダイアログ(Joypad Setting...)
    ○ キー割り当てダイアログ(Keybind...)
    ○ 設定ダイアログ(Configure...)
    ○ 音量設定ダイアログ(Volume...)
    ○ 録画設定ダイアログ(Record Screen)
    ○ 録音設定ダイアログ(Record Sound)
    ○ 仮想キーボード(Virtual Keyboard)
  ● 録画＆録音で使用するライブラリについて
  ● コマンドラインオプション
  ● ドラッグ＆ドロップ
  ● その他補足
    ○ ディスクイメージについて
    ○ カセットテープイメージについて
    ○ キー入力記録ファイル(l3kファイル)について
    ○ ライトペン入力
    ○ ジョイスティック
    ○ 漢字ROM
    ○ LEDインジケータ
  ● 開発環境
  ● 参考文献
  ● 謝辞
  ● クレジット
  ● 免責事項

------------------------------------------------------------------------------
● 主な機能
------------------------------------------------------------------------------

  CPU: スピード0.5～16倍
  RAM: 標準64KB + 拡張64KB(MP-9764を想定)
  画面表示: ハイレゾ最大640x200 8色, IG
  サウンド: MUSIC_SEL, 6重和音PSG(MP-9710を想定), 9重和音PSG(I/O 1983年8月号掲載)
  カセットテープ入出力
  プリンタ出力
  RS-232C入出力
  ライトペン入力: マウスを使ってエミュレート
  漢字ROM: MP-9740を想定
  FDD: 以下を選択して使用可能
       片面単密度(1S) 3インチコンパクトフロッピー(MP-3375, MP-1805)を想定
       両面倍密度(2D) 5.25インチミニフロッピー(MP-3550/MP-3560, MP-1802)を想定
       両面倍密度(2D) 8インチ標準フロッピー(MP-3630, MP-1806)を想定


------------------------------------------------------------------------------
● 動作確認環境
------------------------------------------------------------------------------

  Windows10(64bit)
  Direct3D(DirectX9以上)が正常に動作すること。

  使用デバイス：キーボード、マウス、ジョイスティック

------------------------------------------------------------------------------
● 動作に必要なもの
------------------------------------------------------------------------------

  このソフトの動作には実機のROMイメージが必要です。以下のファイルを用意して
  ください。
  (1) ROM BASIC (BASICを使用する場合必須)
      L3BAS.ROM: アドレス$A000 - $FFFF のイメージ。
        または
      ROM1.ROM:  アドレス$A000 - $FEFF のイメージ。
      ROM2.ROM:  アドレス$FFF0 - $FFFF のイメージ。

    ※$FF00 - $FFEFはI/Oポートになるためこの間はダミーデータで構いません。

  (2) キャラクターフォントイメージ（必須）
      FONT.ROM: キャラクターフォントのイメージ。
                toolフォルダにあるFONT.ROMは拙作のもので実機とは若干イメージが
                異なります。

  (3) ディスクブート用ROMイメージ（DISK BASICを使用する場合）
      MP1802.ROM: 5.25インチミニフロッピーI/Fボード(型番:MP-1802/A)に搭載されて
                  いるROM。アドレス$F800 - $FFFF のイメージ。
                  L3から抜き出したL3 ROM BASICの場合で、5インチFDから起動する場合
                  必須。
      MP1805.ROM: 3インチコンパクトフロッピーI/Fボード(型番:MP-1805)に搭載されて
                  いるROM。アドレス$F800 - $FFFF のイメージ。
                  S1から抜き出したL3 ROM BASICの場合で、3インチFDから起動する場合
                  必須。
      MP1806.ROM: 8インチ標準フロッピーI/Fボード(型番:MP-1806)に搭載されている
                  ROM。アドレス$F800 - $FFFF のイメージ。

  (4) 漢字ROM（任意）
      KANJI.ROM : MP-9740を想定。JIS第一水準(128KB)
                  toolフォルダに擬似漢字ROMイメージを作成するソフトがあります。

  (5) リレー音、FDDシーク音、FDDモータ音ファイル（任意）
      relay_on.wav     : リレーON時の音声ファイル。
      relayoff.wav     : リレーOFF時の音声ファイル。
                     テープのロード/セーブ時に鳴るリレー音です。
      fddseek3.wav     : 3インチFDD使用時のヘッドシーク音ファイル。
      fddmotor3.wav    : 3インチFDD使用時のモータ音ファイル。
      fddheadon3.wav   : 3インチFDD使用時のヘッドロード音ファイル。
      fddheadoff3.wav  : 3インチFDD使用時のヘッドアンロード音ファイル。
      fddseek5.wav     : 5.25インチ(2D)FDD使用時のヘッドシーク音ファイル。
      fddmotor5.wav    : 5.25インチ(2D)FDD使用時のモータ音ファイル。
      fddheadon5.wav   : 5.25インチ(2D)FDD使用時のヘッドロード音ファイル。
      fddheadoff5.wav  : 5.25インチ(2D)FDD使用時のヘッドアンロード音ファイル。
      fddseek8.wav     : 8インチFDD使用時のヘッドシーク音ファイル。
      fddmotor8.wav    : 8インチFDD使用時のモータ音ファイル。
      fddheadon8.wav   : 8インチFDD使用時のヘッドロード音ファイル。
      fddheadoff8.wav  : 8インチFDD使用時のヘッドアンロード音ファイル。
          各ファイルは、無圧縮PCM、11025～48000Hz、8または16bit、モノラル。
          長さが約0.25秒までのもの。

  (6) ffmpegのライブラリ（任意）
      詳細は、「録画＆録音で使用するライブラリについて」を参照してください。

  -----
    CLUB09氏のL3エミュのものを流用する場合は、ファイル内の先頭5バイトと
  末尾5バイトをとり除いてください。対応は以下の通り：
        ROM1 → ROM1.ROM
        ROM2 → ROM2.ROM
        FONT → FONT.ROM


------------------------------------------------------------------------------
● ファイル構成
------------------------------------------------------------------------------

    bml3mk5\
      bml3mk5.exe     ... ソフト本体
      mmf_loader.dll  ... media foundationを使用して録画録音する際に使用する
                          ライブラリ
      locale\         ... ローカライズ用フォルダ
        ja\
          LC_MESSAGES\
            bml3mk5.mo .. 日本語用翻訳ファイル
      readme.txt      ... このファイル
      history.txt     ... 変更履歴
      spec.txt        ... 本ソフトの詳細仕様
    tool\             ... ツール
      FONT.ROM        ... フォントファイル
      kanji\          ... 疑似漢字ROMイメージ作成
        mkkanji.exe   ... 作成プログラム
        kanji.txt     ... 上記で使用する漢字マッピングファイル(JIS第一水準)
        readme.txt    ... 疑似漢字ROMイメージ作り方の説明

------------------------------------------------------------------------------
● インストール
------------------------------------------------------------------------------

  1. アーカイブを解凍するとbml3mk5フォルダがありますので、bml3mk5フォルダを
     任意の場所にコピーしてください。

  【注意】システムフォルダやProgram Filesフォルダにはコピーしないでください。

  2. 実機から取り出したROMイメージを同じフォルダまたは適当なフォルダに置いて
     ください。

   ・キャラクターフォントROMイメージがない場合は、toolフォルダにあるFONT.ROM
     ファイルで代用できます。
   ・漢字のROMイメージがない場合は、toolフォルダにあるmkkanjiを実行して、
     KANJI.ROMファイルを作成できます。

  3. ジョイスティックを使用する場合、予め接続しておいてください。

  4. bml3mk5フォルダにある実行ファイルを起動してください。

     別のフォルダにROMイメージがある場合：
     設定ダイアログの CPU,メモリ(CPU,Memory) -> ROMパス(ROM Path) でROMイメージ
     のあるフォルダを指定した後、操作(Control) -> パワーオン(PowerOn) を
     おこなうか、このソフトを再起動してください。

  5. FDDを使用する場合は、メニューのFDDタイプ(FDD Type)、または、Alt+Fで
     どのFDDを使用するか選択した後、操作(Control) -> パワーオン(PowerOn) を
     おこなうか、このソフトを再起動してください。

    FDDを使用する状態では、前回動作時にFDD0にて最後に使用したディスクイメージを
    起動ディスクとします。

    実行すると、同じフォルダに以下のファイルが作成されます。
      bml3mk5.ini ... 設定ファイル
      bml3mk5.log ... 実行ログ
      keybind.ini ... キー設定ファイル
    ・コマンドラインで設定ファイルを指定すると、そのファイルがあるフォルダ下に
      作成されます。

  起動しない場合：

  ※「msvcp100.dllが見つからなかったため、アプリケーションを開始できませんでした。
    ～」と表示され起動できないときは、
    Visual C++ 2010 SP1 再頒布可能パッケージのインストールが必要です。
    マイクロソフトのページよりインストールしてください。

    https://www.microsoft.com/ja-jp/download/details.aspx?id=26999

    上記以外の場合、bml3mk5.logを開いてエラーメッセージを確認してください。
    ターミナル/コマンドプロンプトから実行して出力されるメッセージを確認
    して下さい。

------------------------------------------------------------------------------
● アンインストール
------------------------------------------------------------------------------

  インストールしたフォルダを削除してください。

------------------------------------------------------------------------------
● 使い方
------------------------------------------------------------------------------

  --------------------------------------------------------------------------
○ メニュー説明

「操作(Control)」メニュー
  「パワーオン(PowerOn)」 ....... 電源を入れなします。（コールドリセット）
          パワーオフ状態を有効にしている場合は、電源オン/オフを切り替えます。
  「モードスイッチ(MODE Switch)」.. モードスイッチ
          チェックを入れて「PowerOn」するとNEW ON 7相当になります。
  「リセットスイッチ(Reset Switch)」.. リセットスイッチ

  「FDDタイプ(FDD Type)」 ....... FDDタイプ サブメニュー
    「FDDなし(No FDD)」.......................... FDDを使用しない。
    「3インチコンパクトFDD(3inch compact FDD)」.. 3インチコンパクトFDDを使用。
    「5.25インチミニFDD(5.25inch mini FDD)」..... 5.25インチミニFDDを使用。
    「8インチ標準FDD(8inch standard FDD)」....... 8インチ標準FDDを使用。

  「ポーズ(Pause)」 ............. ポーズ

  「CPUスピード(CPU Speed)」 .... CPUスピード サブメニュー
    「CPU 0.5倍(CPU x0.5)」...... CPUスピード x0.5～x16倍に切り替えます。
         :
    「CPU 16倍(CPU x16)」

    「デバイスをCPUスピードと同期(Sync Devices With CPU Speed)」 ..........
          チェックすると全体のスピードをCPUスピードに合わせます。
          チェックを外すとCPUスピードのみ変化します。

  「オートキー(Auto Key)」 ...... 自動キー入力 サブメニュー
    「開く...(Open...)」 ........ 指定したファイルの内容を自動で入力します。
    「貼り付け(Paste)」 ......... クリップボードのテキストを自動で入力します。
    「停止(Stop)」 .............. 自動で打ち込み中のテキストを停止します。

  「キーを記録(Record Key)」 .... キー入力記録 サブメニュー
    「再生...(Play...)」 ........ 記録したキー入力記録ファイルを再生します。
    「再生を停止(Stop Playing)」.. キー入力記録ファイルの再生を停止します。
    「記録...(Record...)」 ...... 指定したファイルにキー入力を記録します。
          最初に、現在の状態をステートファイルに保存します。
          次に、キー入力情報を記録するファイルを指定します。
          オープンしているテープイメージ、ディスクイメージがあればその
        ファイルパスも保存します。
          詳細については後述のキー入力記録ファイルについてを参照ください。
    「記録を停止(Stop Recording)」.. キー入力の記録を停止します。

  「状態をロード...(Load State...)」.. 状態ファイルを内部メモリにロードします。
  「状態を保存...(Save State...)」.. 内部メモリの状態を状態ファイルに保存
    します。

  「最近使用した状態ファイル(Recent Status Files)」 ..........
          最近使用したファイル名が最大20ファイル表示されます。
          選択するとこのファイルをロードします。

  【注意】テープやFDDのロード/セーブ中に使用しないでください。
          特にセーブ中に行うとデータを破壊する可能性があります。

  「終了(Exit)」 ................ 本ソフトを終了します。


「テープ(Tape)」メニュー
  「再生...(Play...)」 .......... 再生ボタンを押した状態になります。
          再生したいデータファイルを選択しておき、本体側でロードコマンドを実行
        することでファイルが再生されます。
          サポートしているファイルは、
            wavファイル: PCM（無圧縮）11025/22050/44100/48000Hz 8/16bit
            l3c,l3b,l3,t9xファイル

  「録音...(Rec...)」 ........... 録音ボタンを押した状態になります。
          録音したいデータファイル名をあらかじめ設定し、本体側でセーブコマンド
        を実行することでファイルに書きこまれます。
          保存ダイアログで選択した種類で保存される形式が決まります。
            wavファイル: PCM（無圧縮）サンプリングレートはあらかじめ設定
                                      ダイアログで設定しておきます。
            l3c,l3b,l3,t9xファイル

  「取り出し(Eject)」 ........... カセットを取り出した状態にします。
          再生・録音状態を停止しファイルを閉じます。

  【注意1】デフォルトでは上書きになります。追記する場合は、早送り(F.F.)で
           ファイル末尾まで早送りしてください。
  【注意2】録音終了後は、必ずEjectしてファイルを閉じるようにしてください。

  「巻き戻し(Rewind)」 .......... ファイル先頭まで巻き戻しします。

  「早送り(F.F.)」 .............. ファイル末尾まで早送りします。

  「停止(Stop)」 ................ 巻き戻し・早送りを停止します。

  【注意】再生・録音状態を止めるには取り出しを使用してください。

  「リアルモード(Real Mode)」 ... 実機に近いスピードで再生・録音を行います。
          カセットテーブの遅さが実感できます(^^;
        ・このモードでは再生音（ピーガー音）が発生します。
        ・このモードではMOTOR ONで再生・録音を進めることができます。

  「最近使用したファイル(Recent Files)」 ..........
          最近使用したファイル名が最大20ファイル表示されます。
          選択するとこのファイルを再生状態にします。


「FDD0/1/2/3」メニュー
  「挿入...(Insert...)」 ........ ディスクイメージを開きます。
          マルチボリューム形式のディスクイメージをFDD0で開いた場合、1番目の
        ボリュームをFDD0、2番目のボリュームをFDD1で開きます。同様にFDD2で
        開いた場合、2番目のボリュームをFDD3で開きます。

  【注意】d88形式以外のディスクイメージは正しく読み込めない可能性があります。

  「A/B面に変更(Change Side to A/B)」..【3インチコンパクトFDD使用時のみ】
          ディスクのA面/B面を入れ替えます。

  「取り出し(Eject)」 ........... ディスクイメージを閉じます。
          ディスクに書き込んだデータは、取り出し操作を行うか、約5秒無操作で
        実際のディスクイメージファイルに保存されます。

  【注意】ベタのディスクイメージはデフォルトではd88形式に変換して保存します。
        これは設定で変更できます。

  「新規(New)」 ................. 新規にディスクイメージを作成し開きます。
    「ブランク2Dを挿入(Insert Blank 2D)」 ... 5インチ2Dのディスクイメージ
        3インチ、5インチ単密度のディスクイメージはこちらを選択してください。
    「ブランク2HDを挿入(Insert Blank 2HD)」.. 5インチ2HDのディスクイメージ
        8インチ2Dのディスクイメージはこちらを選択してください。

  【注意】別途フォーマットを行う必要があります。

  「書き込み禁止(Write Protect)」... ライトプロテクト
          OFF->ONに変更した時点で、これまでの変更およびライトプロテクト属性を
        ディスクイメージに保存します。

  【注意】ホストOSの属性で読み込み専用にしている場合、このメニューからライト
          プロテクトを外すことはできません。

  「マルチボリューム(Multi Volume)」 ..........
          複数のディスクイメージが含まれるファイルの場合は、このメニューから
        各ボリュームを選択できます。

  「最近使用したファイル(Recent Files)」 ..........
          最近使用したファイル名が最大20ファイル表示されます。
        選択するとどのドライブで使用するか選択ダイアログが表示されます。


「画面(Screen)」メニュー
  「フレームレート(Frame Rate)」. フレームレート サブメニュー
    「自動(Auto)」 .............. 可変フレームレート。
        フレームレートが安定しないときは固定フレームレートにしてみてください。
    「60fps」 ................... 60fps固定フレームレート。
    「30fps」 ................... 30fps固定フレームレート。
        :
    「10fps」 ................... 10fps固定フレームレート。

  「録画(Record Screen)」 ....... 録画 サブメニュー
    「640x480」............. 録画や画面キャプチャ時の解像度を640x480にします。
    「768x512」............. 録画や画面キャプチャ時の解像度を768x512にします。

    「60fpsで録画(Rec 60fps)」... 60fpsで録画開始します。
    「30fpsで録画(Rec 30fps)」... 30fpsで録画開始します。
          :
    「10fpsで録画(Rec 10fps)」... 10fpsで録画開始します。
          最初、録画ダイアログがでますので録画に使用するライブラリをタブで
        選択し、その後コーデックや品質を選択してください。
          次ボタンを押すとつづけて録音ダイアログがでますので同様に録音の
        コーデックを選択してください。
          開始ボタンを押すと録画＆録音を開始します。
          ffmpegは別途ライブラリをインストールことで録画できます（後述）。

      【注意】動画ファイルと音声ファイルは別々に出力されます。

    「停止(Stop)」 .............. 録画を停止します。
          設定ダイアログのスナップショットパスにて指定したフォルダ、または
        ソフトと同じフォルダに動画ファイルと音声ファイルが<日付日時>の形式で
        作成されます。

    「キャプチャ(Capture)」 ..... 現画面をキャプチャします。
          設定ダイアログのスナップショットパスにて指定したフォルダ、または
        ソフトと同じフォルダに<日付日時>.bmpまたは.pngが作成されます。

  「ウィンドウ(Window)」 ........ ウィンドウモード サブメニュー
    「WWWxHHH xM」 ..... ウィンドウサイズWWW x HHH、倍率M倍で表示。

  「フルスクリーン(Fullscreen)」.. フルスクリーンモード サブメニュー
    「画面を引き伸ばす(Stretch Screen)」..........
          画面のサイズに合わせて表示を拡大します。
    「画面の余白を切る(Cutout Screen)」 ..........
          なるべく画面の余白をなくす形で拡大します。
    「[n] WWWxHHH」 .... n番目のモニタで解像度WWW x HHHで表示。

          フルスクリーンでは、マウスカーソルを画面上部に持っていくことで、
        メニューが表示されます。
          Alt+Return または 画面左上でマウスを右クリックするとウィンドウ
        モードに戻ります。

  「アスペクト比(Aspect Ratio)」 .. アスペクト比変更 サブメニュー
        画面ピクセルの縦横比率を変更します。横幅：縦幅。

  「描画モード(Drawing Mode)」 .... 描画モード サブメニュー
    「フル描画(Full Draw)」 ......... 常にすべてのピクセルを描画
    「走査線(Scanline)」 ............ ブラウン管モニタのように描画
          1ラインごとにとびとびで表示します。
          インターレースモードではチラツキます。
    「縞模様(Stripe)」 .............  1ラインごとにとびとびで交互に描画
          描画処理が若干軽くなりますが、フレーム落ちが発生すると縞模様の残像が
        表示されます。
    「市松模様(Cheker)」 ...........  格子状に描画
          描画処理が若干軽くなりますが、格子状の残像が表示されます。

  「残像モード1(Afterimage1)」 .. 残像モード１
          インターレースでもチラツキが少なくなる長残光形ディスプレイを再現(^^
  「残像モード2(Afterimage2)」 .. 残像モード２
          1フレーム残像が残ります。

  「Direct3Dを使用(同期)(Use Direct3D(Sync))」..........
          Direct3Dを使用してモニタのリフレッシュレートと同期しながら描画。
  「Direct3Dを使用(非同期)(Use Direct3D(ASync))」.......
          Direct3Dを使用してモニタのリフレッシュレートと同期せずに描画。
  「Direct3Dフィルタ(Direct3D Filter)」.......
          Direct3Dを使用して描画する際のフィルタ種類。

  【注意】グラフィックボードがDirect3Dに対応している必要があります。
          対応していない場合このメニューは選択できません。

「サウンド(Sound)」メニュー
  「ボリューム...(Volume...)」 .. 音量を調節するダイアログが表示されます。
  「録音(Record Sound)」 ........ 録音 サブメニュー
    「開始...(Start...)」........ 録音を開始します。
          録音ダイアログがでますので録音に使用するライブラリをタブから選択し、
        その後コーデックを選択してください。
          開始ボタンを押すと録音を開始します。
          ffmpegは別途ライブラリをインストールことで録音できます（後述）。

    「停止(Stop)」............... 録音を停止します。
          音声ファイルは、設定ダイアログのスナップショットパスにて指定した
        フォルダ、またはソフトと同じフォルダに<日付日時>.<拡張子>の形式で
        作成されます。

  「8000Hz」 .................... 再生/録音のサンプリングレートを設定します。
      :
  「96000Hz」

  「50ミリ秒(50msec.)」 ......... 音が出力されるまでのディレイ時間を設定します。
      :
  「400ミリ秒(400msec.)」

  【注意】サンプリングレート、ディレイ時間を反映するにはこのソフトを再起動
          する必要があります。
  ※音が途切れたりする場合はディレイ時間を長めに設定してください。


「デバイス(Devices)」メニュー
   周辺機器に関するメニューです。LPTxがプリンタ、COMxが通信ポートです。

  「LPT0」 .................... プリンタポート(LPT0:)に対する設定メニューです。
          BASIC上でプリンタポートに出力した内容が内部バッファに保持されます。
    「保存...(Save...)」 ........ 内部バッファの印刷データをファイルに保存
          します。
    「mpprinterに印刷(Print to mpprinter)」 ..........
          内部バッファに保存した印刷データをmpprinterに送信します。
    「クリア(Clear)」 ........... 内部バッファをクリアします。

    「オンライン(Online)」 .........
          チェックを外すと、内部の仮想プリンタと切断した状態になります。
        この状態ではmpprinterにも送信されなくなります。

    「mpprinterに同時送信(Send to mpprinter concurrently)」 .........
          プリンタポートに出力した内容を内部バッファに保持する、と同時に
        mpprinterにも送信します。

  ※mpprinterは拙作のプリントデータを閲覧するソフトです。
  【注意】mpprinterはバージョン0.3.0以上を使用してください。
  【注意】ホスト側のパラレルポートに直接接続することはできません。

  「LPT1」 ........... 拡張プリンタポート(LPT1:)に対する設定メニューです。
                       サブメニューの意味はLPT0と同じです。
  「LPT2」 ........... 拡張プリンタポート(LPT2:)に対する設定メニューです。
                       サブメニューの意味はLPT0と同じです。

  【注意】拡張プリンタポートを使用する場合、設定ダイアログにてEx LPT Portに
          チェックを入れて再起動するか「パワーオン(Power On)」してください。


  「COM0」 .................... COMポート(COM0:)に対する設定メニューです。
          このソフトを2台起動し、一方をサーバにし、もう一方から接続することで、
        ネットワークを経由して擬似的に通信することができます。
          また、tera termなどのtelnet端末や、ホスト上のシリアルポートに接続して
        データのやり取りを行うこともできます。

  【注意】BASIC上でCOMポートを使用する前にあらかじめ双方を接続している状態に
          してください。

    「サーバを有効(Enable Server)」.. このソフトをサーバとします。
          もう一方のソフトからの接続を受け付けます。
          telnet端末と通信する場合はここをチェックしてください。
    「接続(Connect)」 ............... 相手先と接続します。
      「イーサネット(Ethernet)」 ..... 
          TCP/IPを使用してサーバと接続します。このソフトをサーバとしている場合、
        相手から接続されるとチェックがつきます。

        ホスト上にシリアルポートがある場合、このメニュー下に有効なポート名の
      一覧が表示されます。ポート名を選択するとそのポートと接続します。

        チェックがついているメニューをもう一度選択すると切断します。

  【注意】イーサネットとシリアルポートを同時に接続することはできません。

    「バイトデータで通信(Comm With Byte Data)」 ..............
          通常は1バイトのデータをビットに分割して通信しますが、チェックを
        入れると1バイトのデータそのままで通信します。
          telnet端末と通信する場合はここをチェックしてください。
    「Telnet用オプション(Options For Telnet)」 ............
          telnet用サブメニュー
      「バイナリモード(Binary Mode)」 ............
          telnet端末をバイナリ送受信可能なモードにします。
          エミュ―レータ内部の動作も切換ます。
          端末との接続が切れた場合、バイナリモードは解除されます。
      「WILL ECHO 送信(Send WILL ECHO)」 ............ 
          telnet端末のラインモードを解除して入力した文字がすぐに送信される
        ようにします。
          バイナリデータを送受信する場合は、バイナリモードを設定する前に
        これを実行してください。

  「COM1」 ........... 拡張COMポート(COM1:)に対する設定メニューです。
                       サブメニューの意味はCOM0と同じです。

  【注意】拡張COMポートを使用する場合、設定ダイアログにてEx COM Portに
          チェックを入れて再起動するか「パワーオン(Power On)」してください。


「オプション(Options)」メニュー
  「LEDを表示(Show LED)」 ............ 画面左側にあるLEDインジケータの表示を
          切り替えます。
  「LEDは画面内(Inside LED)」......... LEDインジケータを画面内部に埋め込むか、
          ポップアップで表示するかを切り替えます。
  「メッセージ表示(Show Message)」 ... 画面内にメッセージを表示するかを
          切り替えます。
  「ログ...(Log...)」 ................ ログダイアログを表示します。

  「ライトペン有効(Enable Lightpen)」. ライトペン機能を有効にするかを
          切り替えます。

  「ジョイパッドを使用(キー割当)」.... ジョイスティックの方向キーや各ボタンを
          キーボードのキーに割り当てて使用します。
  「ジョイパッドを使用(PIA接続)」 .... ジョイスティックをPIAポートに接続した
          ものとして使用します。
  「キーtoジョイパッド有効」 ......... キー入力をジョイスティックとして使用
          します。

  「キー入力にDirectInputを使用」..... キー入力にDirectInputを使用します。
  「キー入力を鈍くする(ゲーム用)」 ... BASICで作られたゲームでキャラクタが進み
          すぎるといった場合に、キーの押しすぎを抑制します。
  「仮想キーボード(Virtual Keyboard)」.. 仮想キーボードウィンドウを開きます。

  「ジョイパッド設定...(Joypad Setting...)」.. ジョイパッドの設定ダイアログ
          (後述)を開きます。
  「キー割り当て...(Keybind...)」 .... キー割り当てダイアログ(後述)を開きます。
  「設定...(Configure...)」 .......... 設定ダイアログ(後述)を開きます。

  「デバッガを開始(Start Debugger)」.. デバッガを開始します。※
  「デバッガを停止(Stop Debugger)」 .. デバッガを停止します。※
    ※搭載バージョンのみ。デバッガの詳細はdebugger.txtを参照してください。


「ヘルプ(Help)」メニュー
  「バージョン情報...(About...)」... バージョンを表示するダイアログを開きます。


  --------------------------------------------------------------------------
○ キー操作説明

  キーボードは日本語キーボードを前提としています。
  デフォルトの特殊なキーの入力方法は以下のとおり。
  ※キー割り当てダイアログにて変更できます。

  レベル3のキー    Windows側のキー
  ---------------- -----------------------------
  [BREAK]          [F9]
  [GRAPH]          [F8] / [無変換]
  [KATA/HIRA]      [TAB] / [カタカナひらがな]
  [DEL/INS]        [Delete] / [BackSpace]
  [CAPSLOCK]       [F7] / [CapsLock]
  [テンキー ?]     [END]
  リセットスイッチ [F11]

  INSERTは[Shift]+[Delete]となります。※レベル3の仕様です

  また、ショートカットキーとして以下があります。
  ※キー割り当てダイアログにて変更できます。

  機能             Windows側のキー
  ---------------- -----------------------------
  ポーズON/OFF     [Pause]

  いくつかのメニューはAltキーと併用して呼び出せます。
  ※Altキーはキー割り当てダイアログにて変更できます。

  メニュー名                                Windows側のキー
  ---------------------------------------- ----------------------------------
  操作(Control)
    パワーオン/オフ(PowerOn/Off)           Alt + F3
    モードスイッチ(MODE Switch)            Alt + M
    リセットスイッチ(Reset Switch)         Alt + R
    FDDタイプモード切り替え                Alt + F
    ポーズ(Pause)                          Alt + Q
    CPU 0.5倍(CPU x0.5)                    Alt + 9
    CPU 1倍(CPU x1)                        Alt + 1
    CPU 2倍(CPU x2)                        Alt + 2
    CPU 4倍(CPU x4)                        Alt + 3
    CPU 8倍(CPU x8)                        Alt + 4
    CPU 16倍(CPU x16)                      Alt + 5
    CPUスピードと同期(Sync With CPU Speed) Alt + 0
    キーを記録(Record Key) -> 再生...(Play...)
                                           Alt + E
    状態をロード...(Load State...)         Alt + O
    終了(Exit)                             Alt + F4
  テープ(Tape)
    再生...(Play...)                       Alt + F7
    巻き戻し(Rewind)                       Alt + F5
    早送り(F.F.)                           Alt + F8
    停止(Stop)                             Alt + F6
  FDD0
    挿入...(Insert...)                     Alt + F9
  FDD1
    挿入...(Insert...)                     Alt + F10
  FDD2
    挿入...(Insert...)                     Alt + F11
  FDD3
    挿入...(Insert...)                     Alt + F12
  画面(Screen)
    画面のキャプチャ(Capture Screen)       Alt + G
    フルスクリーン(Fullscreen)/ウィンドウ(Window)切替
                                           Alt + Enter
    ウィンドウサイズ(Window Size)          Alt + W
    アスペクト比(Aspect Ratio)             Alt + A
    描画モード(Drawing Mode)               Alt + S
    画面を引き伸ばす(Stretch Screen)       Alt + X (Cutout Screenと切替)
    画面の余白を切る(Cutout Screen)        Alt + X (Stretch Screenと切替)
    残像モード1(Afterimage1)               Alt + T (Afterimage2と切替)
    残像モード2(Afterimage2)               Alt + T (Afterimage1と切替)
    Direct3Dを使用(同期)(Use Direct3D(Sync))
                                           Alt + Y (Direct3D Asyncと切替)
    Direct3Dを使用(非同期)(Use Direct3D(ASync))
                                           Alt + Y (Direct3D Syncと切替)
    Direct3Dフィルタ(Direct3D Filter)      Alt + U
  サウンド(Sound)
    ボリューム...(Volume...)               Alt + V
  オプション(Options)
    LEDを表示(Show LED)                    Alt + L (Inside LEDと切替)
    LEDは画面内(Inside LED)                Alt + L (Show LEDと切替)
    メッセージ表示(Show Message)           Alt + Z
    ジョイパッド使用(キー割当)(Enable Joypad(Key Assigned))
                                           Alt + J (PIA Typeと切替)
    ジョイパッド使用(PIA接続)(Enable Joypad(PIA Type))
                                           Alt + J (Key Assignedと切替)
    ライトペン有効(Enable Lightpen)        Alt + Ctrl
    キー割り当て...(Keybind...)            Alt + K
    設定...(Configure...)                  Alt + C
    デバッガを開始(Start Debugger)         Alt + D
  ---------------------------------------- ----------------------------------
  LEDインジケータ表示位置変更              Alt + P

  また、フルスクリーン時に画面左上でマウスを右クリックするとウィンドウモードに
  戻ります。


  --------------------------------------------------------------------------
○ ジョイパッド設定ダイアログ(Joypad Setting...)

    各ボタンの連射状態と割り当て、およびアナログスティックの感度を設定します。

  ■連射スピード

  各ポートの連射状態を設定します。0で連射なし、3で最大スピード連射となります。

  ■アナログ→デジタル感度

  アナログスティックを十字キーとして使用する場合にその感度を設定します。

  ■ジョイパッド(PIA接続)(Joypad (PIA Type))

  ジョイスティックの十字キー、アナログスティックおよびボタン1～28を
  拡張PIAカードのBポート($FF62-$FF63)または標準PIAのAポート($FFC0-$FFC1)の
  信号に対応付けします。

  枠内の変更したい部分にマウスカーソルを合わせクリックしてください。
  割り当てたいボタンをジョイスティックから入力してください。
  割り当てたボタンを消去するにはマウスの左ボタンをダブルクリックしてください。

  ジョイスティックは1台のみです(2台目の設定は無視されます)。

  割り当てが終わったらダイアログ下側にある「プリセットxに保存(Save Preset x)」
  ボタンで状態を保存することができます。

  ダイアログ下側にある「デフォルトをロード(Load Default)」ボタンを押すと
  初期状態に戻ります。
  「プリセットxをロード(Load Preset x)」ボタンで保存した割り当てに変更できます。

  【注意】このダイアログを開く前にメニューの「ジョイパッドを使用(PIA接続)」に
          チェックを入れて使用する状態にしてください。

  ■キーtoジョイパッド(Key to Joypad)

  キー入力をジョイスティックの方向キーやボタンとして使用します。

  枠内の変更したい部分にマウスカーソルを合わせクリックしてください。
  割り当てたいキーをキーボードから入力してください。
  割り当てたキーを消去するにはマウスの左ボタンをダブルクリックしてください。

  ■信号は負論理(Signals are negative logic)

  チェックをはずすとボタンを押したときに"1"になります。
  チェックをいれるとボタンを押したときに"0"になります。

  ■標準PIAのAポートに接続(Connect to standard PIA A port)

  チェックをはずすと拡張PIAカードのBポート($FF62-$FF63)に、
  チェックをいれると標準PIAのAポート($FFC0-$FFC1)に接続します。

  ■Z軸有効、R軸有効、U軸有効、V軸有効

    ジョイスティックによっては、アナログスティックが押しっぱなしになり割当てが
  できない場合があります。このような場合は該当する軸のチェックをはずすことで
  一時的にその軸の入力を無効にすることができます。


  --------------------------------------------------------------------------
○ キー割り当てダイアログ(Keybind...)

  ■キーボード(Keyboard)

  ホスト側のキーとLEVEL3のキーの割り当てを設定します。
  LEVEL3のキー1つにつき、ホスト側のキー2つまで割り当てることができます。

  枠内の変更したい部分にマウスカーソルを合わせクリックしてください。
  割り当てたいキーをキーボードから入力してください。
  割り当てたキーを消去するにはマウスの左ボタンをダブルクリックしてください。

  割り当てが終わったらダイアログ右側にある「プリセットxに保存(Save Preset x)」
  ボタンで状態を保存することができます。

  ダイアログ右側にある「デフォルトをロード(Load Default)」ボタンを押すと
  初期状態に戻ります。
  「プリセットxをロード(Load Preset x)」ボタンで保存した割り当てに変更できます。

  【ダイアログ内のLEVEL3側のキー名称の補足】
   RESET    ... リセットボタン
   (ポーズ) ... ポーズON/OFF (本ソフト独自のキーです。)
   (Alt) ...... ショートカットキー

  【注意】ホスト側のキー名称はJPキーボードを前提にしています。
  【注意】ホスト側のAlt,menu,F10の各キーは割り当て可能ですがシステムキーの
          ため同時にメニューが開くなどの弊害が発生します。
  【注意】バージョン1.5未満の割り当て設定は無視され初期化されます。

  ■ジョイパッド(キー割当)(Joypad (Key Assigned))

  ジョイスティックの十字キー、アナログスティックおよびボタン1～28をLEVEL3の
  キーに割り当てることができます。

  枠内の変更したい部分にマウスカーソルを合わせクリックしてください。
  割り当てたいボタンをジョイスティックから入力してください。
  割り当てたボタンを消去するにはマウスの左ボタンをダブルクリックしてください。

  ジョイスティック2台まで対応しています。

  ダイアログ下部にある「2つのボタンを押したとき、別のキーと認識する(Recognize as
  another key when pressed two buttons)」をチェックすると、ボタンの同時押しや
  十字キーを斜めに入れた場合に別のキーとして判定するようになります。

  【注意】このダイアログを開く前にメニューの「ジョイパッドを使用(キー割当)」に
          チェックを入れて使用する状態にしてください。

  ■Z軸有効、R軸有効、U軸有効、V軸有効

    ジョイスティックによっては、アナログスティックが押しっぱなしになり割当てが
  できない場合があります。このような場合は該当する軸のチェックをはずすことで
  一時的にその軸の入力を無効にすることができます。


  --------------------------------------------------------------------------
○ 設定ダイアログ(Configure...)

  ■モード(Mode)タブ

   ●DIPスイッチ(DIP Switch)
    モードスイッチ(MODE Switch) ... モードスイッチ
          チェックを入れるとNEW ON 7相当、チェックを外すとNEW ON 3相当に
        なります。

    左側の「>」は現在のモードを表しています。
    設定を反映させるには、このソフトを再起動するか、
    メニューの操作(Control) -> パワーオン(PowerOn) を行なってください。

   ●FDDタイプ(FDD Type)
    FDDなし(No FDD) ..........
           FDDを使用しない。
    3インチコンパクトFDD(3inch compact FDD) ..........
           3インチコンパクトFDDを使用する。
    5.25インチミニFDD(5.25inch mini FDD) ..........
           5.25インチミニFDDを使用する。
    8インチ標準FDD(8inch standard FDD) ..........
           8インチ標準FDDを使用する。

    左側の「>」は現在のFDDモードを表しています。
    設定を反映させるには、このソフトを再起動するか、
    メニューの操作(Control) -> パワーオン(PowerOn) を行なってください。

   ●パワーオフの状態を有効(Enable the state of power off)
      チェックを入れると、メニューの操作(Control) -> パワーオン(PowerOn) で
    パワーオン/オフの状態を切り替えることができるようになります。
      チェックを外すと、常にパワーオン状態となります。

   ●I/Oポートアドレス(I/O Port Address)
    どの周辺機器を有効にするかを指定します。
     ◆6声PSG(6voice PSG)        $FF30 - $FF33 ...
      6重和音PSGカード
     ◆拡張プリンタポート(Ex LPT Port) $FF3C - $FF3F ...
      増設プリンタカード(拡張プリンタポート)
     ◆拡張通信ポート(Ex COM Port)     $FF40 - $FF41 ...
      増設RS-232Cカード(拡張COMポート)
     ◆9声PSG(9voice PSG)        $FF70 - $FF7F ...
      9重和音PSGカード
      ・KANJI ROMとはアドレスが重複するため同時に使用出来ません。
     ◆漢字ROM(KANJI ROM)        $FF75 - $FF76 ...
      漢字ROMカード(JIS第一水準)
      ・9voice PSGとはアドレスが重複するため同時に使用出来ません。
     ◆IG無効(Disable IG)        $FFE9 ...
      チェックを入れるとIGによるキャラクタ表示が無効になります。
      (初代レベル3/マーク2互換)
     ◆リアルタイムクロック(Real Time Clock)  $FF38 - $FF3A ...
      パワーオン時に内蔵時計をホスト側の時刻に合わせます。

    左側の「>」は現在有効なボードを表しています。
    設定を反映させるには、このソフトを再起動するか、
    メニューの操作(Control) -> パワーオン(PowerOn) を行なってください。

  ■画面(Screen)タブ

   ●描画(Drawing)
    方法(Method) : 画面描画方法を指定します。
     デフォルト(Default)
      ...... アプリケーションに任せる
     Direct3Dを使用(同期)(Use Direct3D(sync))
      ...... Direct3Dを使用する（リフレッシュレートと同期）
     Direct3Dを使用(非同期)(Use Direct3D(async))
      ...... Direct3Dを使用する（リフレッシュレートと非同期）
    フィルタ種類(Filter Type) : 画面を拡大した時の補間方法を指定します。
                               (Direct3Dを使用するにした時のみ有効)
     なし(None) ................... 補間なし
     点(Point) .................... 点補間
     リニア(Linear) ............... バイリニア補間

   ●LED
    LEDインジケータを表示するか、画面内か画面外かを指定します。
    位置(Position) : LEDインジケータの表示位置を指定します。

   ●CRTC
    Disptmgスキュー(Disptmg Skew) : 画面の表示タイミングを調整します。
    Curdispスキュー(Curdisp Skew) : 画面のカーソル表示位置を調整します。

   ●キャプチャ種類(Capture Type)
    画面キャプチャ時のファイルのフォーマット種類を指定します。

   ●スナップショットパス(Snapshot Path)
    画面キャプチャや録画録音時の保存先フォルダを指定します。
    空欄の場合、本ソフトのあるフォルダになります。

   ●フォントファイル(Font File)
    システムにインストールされていないフォントを使用する場合にそのファイルを
    指定します。

   ●メッセージフォント(Message Font)
    画面左下に表示されるメッセージのフォント名とサイズを指定します。

   ●情報フォント(Info Font)
    画面右上に表示されるメッセージのフォント名とサイズを指定します。

   ●言語(Language)
    メニューなどの言語を指定します。
      System Dependent .... ホスト側の言語設定に合わせます。
      Default (English) ... デフォルト(英語)設定にします。
      Japanese ............ 日本語設定にします。

    ※ホスト側OSが指定した言語に対応していない場合はデフォルト設定になります。

  ■テープ, FDD(Tape, FDD)タブ

   ●テープからwavファイルロード(Load Wav File from Tape)
    wavファイルからカセットテープイメージをロードする場合の解析方法を設定します。
     波形を反転(Reverse Wave) ... 波形を反転して解析する。
     半波(Half Wave) ............ 半波長の波を検出して解析する。
     補正(Correct) .............. 波形を補正してから解析する。
      COS波(COS Wave) ........... cos波で補正する。
      SIN波(SIN Wave) ........... sin波で補正する。
      1200Hz, 2400Hz ............ 補正に使用する正弦波の振幅を指定する。

    ※詳細は拙作のソフトwavtoolのドキュメントを参照ください。

   ●テープにwavファイル保存(Save Wav File to Tape)
    カセットテープイメージをwavファイルでセーブする場合のサンプリングレートを
    設定します。

   ●起動時にマウントするディスク(When Start Up, mount drive at) ...
    本ソフト起動時にFDイメージをマウントする（開く）かを指定します。
    チェックしたドライブがマウント対象になります。

   ●セクタ検索時の遅延を無視する。(Ignore delays to find sector.) ...
    FDのアクセススピードはディスクイメージのセクタ順序で大きく変わりますが、
    これにチェックを入れるとセクタ順序を無視するため、ディスクアクセスが速く
    なります。

   ●トラックシーク時の遅延を無視する。(Ignore delays to seek track.) ...
    これにチェックを入れるとディスクアクセスが速くなります。

   ●密度のチェックを抑制する。(Suppress checking for density.) ...
    これにチェックを入れると単密度と倍密度の違いを無視します。

   ●メディア種類のチェックを抑制する。(Suppress checking for media type.) ...
    これにチェックを入れると2Dと2HDの違いを無視します。

   ●ベタディスクイメージをそのまま保存する。(Save a plain disk image as it is.)
    ベタのディスクイメージはデフォルトではd88形式に変換して保存します。
    これにチェックを入れるとそのままベタイメージで保存します。

  ■ネットワーク(Network)タブ

   ●LPT0 ～ LPT2
    ホスト名(Hostname) ... mpprinterを起動しているホスト名を指定します。
    ポート(Port) ......... mpprinterが受け付けているポート番号を指定します。
    印刷遅延(Print Delay). mpprinterへ送信するまでの遅延時間を指定します。
                           0.1～1000ミリ秒の範囲で設定できます。
    ※イーサネット通信はTCP/IP(IPv4)で行います。

   ●COM0 ～ COM1
    ホスト名(Hostname) ... サーバとして起動しているときは、受付可能ホスト名を
          指定します。0.0.0.0とすると全ホストからの受付が可能になります。
          クライアントの場合は接続先ホスト名を指定します。
    ポート(Port) ......... サーバとして起動しているときは、受付可能ポート番号を
          指定します。クライアントの場合は接続先ポート番号を指定します。
    通信速度 ...
      300ボー(BASICで"S"指定時) / 1200ボー(BASICで"F"指定時)
      600ボー(BASICで"S"指定時) / 2400ボー(BASICで"F"指定時)
      1200ボー(BASICで"S"指定時) / 4800ボー(BASICで"F"指定時)
      2400ボー(BASICで"S"指定時) / 9600ボー(BASICで"F"指定時)
    ※9600ボーはBASICでは動作保証していないようです。
    ※イーサネット通信はTCP/IP(IPv4)で行います。

   ●デバッガに接続可能なホスト(Connectable host to Debugger)
    デバッガ起動時にtelnet端末からデバッガ操作用のコンソールに接続できます。
    ※デバッガ搭載バージョンのみ。
    ※イーサネット通信はTCP/IP(IPv4)で行います。

   ●ホスト上のシリアルポートの設定(Settings of serial ports on host)
    エミュレータ上のCOMポートとは別に設定します。
    通信速度はエミュレータ上のCOMポート以上の速度を設定してください。
      ボーレート(Baud Rate) ..... 通信速度
      データビット(Data Bit) .... データビット数
      パリティ(Parity) .......... パリティ有無
      ストップビット(Stop Bit) .. ストップビット数
      フロー制御(Flow Control) .. フロー制御
    ※この設定を変更した場合はシリアルポートを再接続してください。

  ■CPU, メモリ(CPU, Memory)タブ

   ●ROMパス(ROM Path)
    ROMイメージ、リレー音、FDDシーク音があるフォルダを指定します。
    空欄の場合、本ソフトのあるフォルダになります。

   ●拡張メモリを使用する(Use Extended Memory)
    拡張メモリを使用するかどうかを指定します。

   ●CPUが未定義命令を読み込んだ時にメッセージを表示する。(Show message when
     the CPU fetches undefined opcode.)
      CPUが未定義命令を読み込んだ時に画面およびログにメッセージを表示するか
    どうかを指定します。

   ●パワーオン時にCPUのレジスタをクリアする。(Clear CPU registers at power on.)
     チェックを入れるとパワーオン時にCPUのレジスタをゼロクリアします。


  --------------------------------------------------------------------------
○ 音量設定ダイアログ(Volume...)

  サウンドデバイスから出力される音量を設定します。

  マスター(Master) .. 全体の音量を設定します。
  Beep .............. ビープ音(MUSIC_SEL)から出力される音量を設定します。
  6声(6voice)PSG .... 6重和音PSGから出力される音量を設定します。
  9声(9voice)PSG .... 9重和音PSGから出力される音量を設定します。
  リレー(Relay) ..... リレー音の音量を設定します。
  CMT ............... カセットテープの再生音の音量を設定します。
  FDD ............... FDDシーク音、モータ音の音量を設定します。

  ミュート(Mute)にチェックすると無音にできます。


  --------------------------------------------------------------------------
○ 録画設定ダイアログ(Record Screen...)

  録画時の設定を行います。タブを選択して使用するライブラリを決めてください。
  Windows: video for windows, media foundation, ffmpeg

  コーデック(Codec) ... 動画ファイルの形式を選択します。
  品質(Quality) ....... 動画ファイルの品質を選択します。

  【注意】コーデックによっては正常に出力されない場合もあります。


  --------------------------------------------------------------------------
○ 録音設定ダイアログ(Record Sound...)

  録音時の設定を行います。タブを選択して使用するライブラリを決めてください。
  Windows: wave, media foundation, ffmpeg

  コーデック(Codec) ... 音声ファイルの形式を選択します。

  【注意】コーデックによっては正常に出力されない場合もあります。


  --------------------------------------------------------------------------
○ 仮想キーボード(Virtual Keyboard)

    SHIFT, CTRL, GRAPHキーはON/OFF切換になります。一回押すと押しっぱなしになり、
  もう一回押すと解除されます。

------------------------------------------------------------------------------
● 録画＆録音で使用するライブラリについて
------------------------------------------------------------------------------

  media foundationは、Windows7以降で使用できます。

  ffmpegを使用する場合は、別途以下の要領でDLLライブラリを入手してください。

  Windows:

  1. DLLビルドを提供しているサイトからダウンロードします。
     64ビットバージョンは、
       https://www.gyan.dev/ffmpeg/builds/
     にある
       ffmpeg-4.4.1-full_build-shared.7z をダウンロードします。
     追記: 2024/10現在、Github内の以下にあります。
       https://github.com/GyanD/codexffmpeg/releases/tag/4.4.1

     あるいは
       https://github.com/tsukumijima/DTV-Builds/blob/master/FFmpeg-4.4-64bit-Shared.7z
       から画面左の「・・・」を選択しダウンロードを選ぶ。

     32ビットバージョンは、
       https://github.com/tsukumijima/DTV-Builds/blob/master/FFmpeg-4.4-32bit-Shared.7z
       から画面左の「・・・」を選択しダウンロードを選ぶ。

  2. ダウンロードしたファイルから、以下のdllファイルを本ソフトと同じフォルダに
     入れるか、システムフォルダに入れてください。
        avcodec-58.dll
        avutil-56.dll
        avformat-58.dll
        swresample-3.dll
        swscale-5.dll

  （ソースファイルからビルドする場合は、ffmpeg-4.x.xを入手してください。）
   FFMpegのページ： http://www.ffmpeg.org/

------------------------------------------------------------------------------
● コマンドラインオプション
------------------------------------------------------------------------------

  bml3mk5 [-i <ini_file>] [-t <tape_file>] [-d <disk_file>] [-s <state_file>]
          [-a <autokey_file>] [-k <recordkey_file>] [<support_file> ...]

  <ini_file> : 設定(ini)ファイル。これを指定するとこのファイルのあるフォルダに
               キー設定(keybind.ini)ファイルとログ(bml3mk5.log)ファイルも出力
               します。
  <tape_file>: 起動時にオープンするテープイメージファイル。
  <disk_file>: 起動時にオープンするディスクイメージファイル。
  <state_file>: ステートファイルをロードして起動します。
  <autokey_file>: 自動キー入力用テキストファイル。起動とともに入力を開始します。
  <recordkey_file>: キー入力記録ファイル。起動とともに再生を開始します。
  <support_file>: 設定ファイル、テープファイル、ディスクファイル、ステート
                  ファイル、自動キー入力用テキストファイル、キー入力記録ファイル
                  のいずれか。
                  ファイル種類は拡張子で判定します。

------------------------------------------------------------------------------
● ドラッグ＆ドロップ
------------------------------------------------------------------------------

    ウィンドウにファイルをドロップすると、拡張子から対応しているかを判定して
   対応しているファイルならそれをオープンします。

------------------------------------------------------------------------------
● その他補足
------------------------------------------------------------------------------

  --------------------------------------------------------------------------
 ○ ディスクイメージについて

  d88形式での使用を前提にしています。
  ベタ形式はDISK BASIC標準のフォーマット以外は動作確認していません。

  【3インチコンパクトフロッピーディスク】
  ディスクイメージは片面単密度(1S) x 2となりますが、両面倍密度(2D)であれば
  使用出来ます。パラメータとしては、
    40シリンダ(トラック/片面)
     2ヘッド
    16セクタ/1トラック
   128バイト/セクタ ... 256バイトでも使用出来ますが、本ソフトでは128バイトを
                        超えるデータは無視されます。

  【5.25インチミニフロッピーディスク】
  ディスクイメージは両面倍密度(2D)となります。
  パラメータとしては、
    40シリンダ(トラック/片面)
     2ヘッド
    16セクタ/1トラック片面
   256バイト/セクタ

  【8インチ標準フロッピーディスク】
  ディスクイメージは両面倍密度(2D)となります。
  パラメータとしては、
    77シリンダ(トラック/片面)
     2ヘッド
    26セクタ/1トラック片面
   256バイト/セクタ


  --------------------------------------------------------------------------
 ○ カセットテープイメージについて

  ■wavファイル
    音声データです。無圧縮PCM、11025/22050/44100/48000Hz、8/16bitに対応。

  ■l3cファイル
    音声データを4800Hzで区切り、HighLevelなら"1"、LowLevelなら"0"としたもの。
      1200Hzなら"1100"(または"0011")
      2400Hzなら"1010"(または"0101")
    となります。
    このファイルはテキストファイルで"0"と"1"で表現します。

  ■l3bファイル
    シリアルデータです。
    一般的にシリアルデータは、
      スタートビット("0") + 8データビット + 2ストップビット("11")
    で表現されます。
    このファイルはテキストファイルで"0"と"1"で表現します。

  ■l3ファイル
    テープイメージです。シリアルデータからスタートビット、ストップビットを
    除いたデータになります。
    テープイメージには、SAVE時に指定したファイル名、チェックサムなどの付加情報
    が含まれています。
    このファイルはバイナリファイルです。

  ■t9xファイル
    eMB-689Xで使用されているテープイメージです。シリアルデータをバイナリ形式
    で保存したデータになります。
    明確な仕様書が無いため暫定対応です。


  --------------------------------------------------------------------------
 ○ キー入力記録ファイル(l3kファイル)について

    このファイルはテキスト形式で記述されています。
   記録開始時に、オープンしているファイルがあればそのファイルへのパスも保存
   します。保存するパスは以下のとおり。
    StateFile: ... ステートファイル。再生時に同時に読み込みます。
    TapeFile:  ... テープイメージ。再生時にオープンします。
    TapeType:  ... "Play" or "Rec"を指定。
    Disk0File: ... FDD0のディスクイメージ。再生時にオープンします。
    Disk1File: ... FDD1のディスクイメージ。再生時にオープンします。
    Disk2File: ... FDD2のディスクイメージ。再生時にオープンします。
    Disk3File: ... FDD3のディスクイメージ。再生時にオープンします。

  【注意1】メニュー操作やダイアログ表示中のキー操作は記録されません。
  【注意2】再生中もキー入力は受け付けます。再生中にキー入力やメニュー操作を
           行うと記録時とは異なる動作になり思いどおりに再生されません。
  【注意3】ゲームなどシビアな入力では思いどおりに再生されないことが多いです。


  --------------------------------------------------------------------------
 ○ ライトペン入力

    マウスカーソルで画面内を指定し左クリックすると押した状態になります。
   なお、本ソフトでは画面の明るさに関係なく押した状態になります。


  --------------------------------------------------------------------------
 ○ ジョイスティック

    USB接続もので動作確認しています。
    ジョイスティックからキー入力できる他に、拡張PIAカードのBポート($FF62-$FF63)
   または標準PIAのAポート($FFC0-$FFC1)への接続をエミュレートします。
    本ソフト起動中にジョイスティックを抜き差しした場合は、一度、キー割り当て
   ダイアログで入力可能かを確認してください。
    ※本ソフトではPSGの汎用ポートに接続するジョイスティックのエミュレートには
      対応していません。


  --------------------------------------------------------------------------
 ○ 漢字ROM

  ■擬似漢字ROMイメージの作成
    toolフォルダ内のkanjiフォルダにあるmkkanji.exeは「ＭＳ ゴシック」を使用して
   擬似漢字ROMイメージを作成します。
    詳細は各フォルダ内のreadme.txtを参照してください。

  ■漢字ROMイメージのフォーマット
   JIS第一水準の漢字イメージは以下のようになります。
    1,2バイト目がIOポート$FF75,$FF76に$0000を書き込んだ時の$FF75,$FF76の値
    3,4バイト目がIOポート$FF75,$FF76に$0001を書き込んだ時の$FF75,$FF76の値
    5,6バイト目がIOポート$FF75,$FF76に$0002を書き込んだ時の$FF75,$FF76の値
     ………
   漢字ROM ICそのものから取り出したものと構成が異なる場合があります。


  --------------------------------------------------------------------------
 ○ LEDインジケータ

   左から、
   ・カタカナ/ひらがな選択時点灯
   ・CapsONで点灯
   ・カセットテープ(再生時、再生セット時、録音時、録音セット時にそれぞれ点灯)
   ・カセットテープのカウンタ
   ・FDDタイプ(3... 3インチ選択時、5... 5インチ選択時、8... 8インチ選択時点灯)
   ・FDD0～3(アクセス時LED点灯、マウント時に数字が点灯)
   となります。

    カセットテープのカウンタ値は、同じプログラムでもテープイメージの形式で
   変わります。


------------------------------------------------------------------------------
● 開発環境
------------------------------------------------------------------------------

  Microsoft Windows10 (64ビット環境)
  Microsoft Visual C++ 2010 Express Edition
  Microsoft WindowsSDK 7.1
  Microsoft DirectX SDK (June 2010)
  CPU: Corei7 4770S 3.1GHz / Mem: 8GB


------------------------------------------------------------------------------
● 参考文献
------------------------------------------------------------------------------

  HITACHI PERSONAL COMPUTER ベーシックマスターレベル3マーク5 入門書 - 日立製作所/日立家電販売 1983
  HITACHI PERSONAL COMPUTER ベーシックマスターレベル3マーク5 文法書 - 日立製作所/日立家電販売 1983
  HITACHI PERSONAL COMPUTER ベーシックマスターレベル3マーク5 取扱説明書 - 日立製作所/日立家電販売 1983
  I/O別冊 ベーシックマスター活用研究 - 工学社 1982
  レベル3BASIC入門 - アスキー出版 1981
  マイクロコンピュータMC6809の考え方 - オーム社 1982

------------------------------------------------------------------------------
● 謝辞
------------------------------------------------------------------------------

  このソフトの制作にあたり多大なるご協力をいただいた方々に大変感謝いたします。
  また、このソフトを公開するにあたり心よく許諾していただいた武田氏に感謝いたします。
  Common Source Code Project Webページ:
    http://takeda-toshiya.my.coocan.jp/


------------------------------------------------------------------------------
● 免責事項
------------------------------------------------------------------------------

・このソフトはフリーウェアです。ただし、著作権は放棄しておりません。
  実行モジュールについては作者Sasajiにあります。
  ソースコードについてはそれぞれの作者にあります。
・このソフトによって発生したいかなる損害についても著作権者は一切責任を負いません。
  このソフトを使用するにあたってはすべて自己責任で行ってください。
・雑誌やネットなどに転載される場合、不特定多数の方に再配布を行う場合でも
  承諾の必要はありませんが、転載の旨をご連絡いただけたら幸いです。

==============================================================================

連絡先：Sasaji (sasaji@s-sasaji.ddo.jp)
 * My WebPage: http://s-sasaji.ddo.jp/bml3mk5/
 * GitHub:     https://github.com/bml3mk5/EmuB-6892
 * X(Twitter): https://x.com/bml3mk5

==============================================================================

